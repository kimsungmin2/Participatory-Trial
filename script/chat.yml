config:
  target: 'http://localhost:3000/'
  socketio:
    transports: ['websocket']
    extraHeaders:
      cookie: 'authorization=Bearer%20eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOjEsImlhdCI6MTcxNDQ4ODYyNywiZXhwIjoxNzU3Njg4NjI3fQ.o10waArAEvkGAeEeFxqk_ZUZKJ__UPe3ByivOUcwqyQ'
  phases:
    - duration: 300 # 5분
      arrivalRate: 1
      rampTo: 1000
      name: 'ramp up to 1000 users'
scenarios:
  - engine: 'socketio'
    flow:
      - emit:
          channel: 'join'
          data:
            roomId: 1
            channelType: 'trials'
      - loop:
          - emit:
              channel: 'createChat'
              data:
                roomId: 1
                message: 'Message number {{ $randomNumber(1, 10000) }}'
                channelType: 'trials'
          - think: 3 # 30초에 10번 메시지를 보내려면, 각 메시지 사이에 3초 대기
            count: 10 # 10번 반복
      - think: 250 # 채팅 이후에 추가로 대기하여 총 5분을 유지
      - emit:
          channel: 'leaveRoom'
          data:
            roomId: 1
            userId: 1
            channelType: 'trials'
